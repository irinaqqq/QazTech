{% load static %}
<header>
<style>
@keyframes fadeInFromTop {
  0% {
    opacity: 0;
    transform: translateY(-100px); /* Начальное положение - поднять на 50px */
  }
  100% {
    opacity: 1;
    transform: translateY(0); /* Конечное положение - без смещения */
  }
}
</style>
    <div class="p-4 text-center bg-white border-bottom" style="padding-bottom: 0!important;">
      <div class="container-fluid" style="width: 100%; margin: 0;">
        <div class="row" style="width: auto;">
          <div class="col-md-3 d-flex justify-content-center justify-content-md-start mb-3 mb-md-0">
            <a href="{% url 'home' %}" class="ms-md-2 d-flex">
              <img src="{% static 'images/qt3.png' %}" height="50" />
            <div style="color: #00a2e8; line-height: 1.2rem; padding-top: 0.5rem;" class="my-auto font-inter">
              <strong style="font-size: 35px;" class="font-inter">QAZAQ</strong> 
              <br>
              <p style="font-size: 16px; color: black;"><strong> TECHNOLOGY</strong></p>
            </div>
          </a>
          </div>
          <div class="col-md-5 justify-content-center align-items-center my-auto">
            <form action="{% url 'search' %}" method="GET" class="d-flex input-group w-auto my-auto md-4 rounded">
              <input autocomplete="off" type="search" name="q" class="form-control form-control-lg" placeholder="Что вы ищете сегодня?" style="padding: 24px;"/>
              <button type="submit" class="btn btn-primary d-none d-lg-flex py-auto" style="box-shadow: none; border-top-right-radius: 0.25rem; border-bottom-right-radius: 0.25rem;"><i class="fas fa-search" style="margin: auto;"></i></button>
              <div class="navs" style="margin-left: 1rem;">
              <a href="javascript:void(0);" class="icon" onclick="myFunction()" style="color: #00a2e8;">
                <i class="fa fa-bars fa-3x"></i>
              </a> 
              </div>    
          </form>      

        </div>
        <div class="col-md-3 d-flex justify-content-center justify-content-md-end align-items-center"> 
 
        </div>
      </div>
    </div>

        <div class="navbar-nav flex-row borderXwidth d-flex" id="myTopnav" style="width: 100%; padding: 1rem;">
          {% for category in categories %}
          <a class="nav-link" href="{% url 'category_products' category.id %}" data-category-id="{{ category.id }}">{{ category.name }}</a>
      {% endfor %}      
      </div>
    </div>
      <div id="hoveredCategoryProducts" style="display: none; position: absolute; z-index: 9999; background-color: white; overflow: hidden; width: 100%;">
    </div>
    <script>
$(document).ready(function() {
    var isHovered = false; // Флаг для отслеживания наведения на #hoveredCategoryProducts

    // Функция для показа товаров
    function showProducts() {
    // Проверяем размер экрана
    if ($(window).width() < 992) {
        $('#hoveredCategoryProducts').hide(); // Скрываем элемент, если размер экрана меньше 992px
        return; // Завершаем выполнение функции
    }

    var category_id = $(this).data('category-id');
    $.ajax({
        url: '/get_category_products/',
        method: 'GET',
        data: {'category_id': category_id},
        success: function(data) {
            var products = data.products;
            var limit = 9;
            if (products.length > 0) {
                var productList = '<div class="row g-5 px-5 my-2">'; // Начинаем с контейнера
                for (var i = 0; i < Math.min(products.length, limit); i++) {
                    productList += '<div class="col-md-3 mx-3" style="width: 11%; opacity: 0; margin:0; padding:0;">';
                    productList += '<a href="' + products[i].url + '" class="h-100">';
                    productList += '<div class="card h-100" style="box-shadow: none;">';
                    productList += '<img src="' + products[i].image_url + '" class="card-img-top" alt="' + products[i].name + '" style="width:170px;height:170px;"/>';
                    productList += '<div class="card-body d-flex" style="padding:0.25rem;">';
                    productList += '<div class="m-auto">';
                    productList += '<h5 class="card-title" style="font-size:1rem;">' + products[i].name + '</h5>';
                    productList += '</div>';
                    productList += '</div>';
                    productList += '</div>';
                    productList += '</a>';
                    productList += '</div>';
                }
                productList += '</div>'; // Заканчиваем контейнером
                $('#hoveredCategoryProducts').html(productList);
                $('#hoveredCategoryProducts').fadeIn();
                // Показываем товары с анимацией fadeIn и задержкой
                $('#hoveredCategoryProducts').find('.row .col-md-3').each(function(index) {
                    $(this).css('animation', 'fadeInFromTop 1s ease ' + (index * 0.2) + 's forwards');
                });
            } else {
                $('#hoveredCategoryProducts').hide(); // Скрываем элемент, если нет товаров
            }
        },
        error: function(error) {
            console.log(error);
        }
    });
}

// Вызываем функцию при загрузке страницы и изменении размера окна
$(document).ready(function() {
    showProducts(); // Вызываем при загрузке страницы
    $(window).resize(showProducts); // Вызываем при изменении размера окна
});


    // Показываем товары при наведении на ссылку в навбаре
    $(".nav-link").mouseenter(showProducts);

    $(".nav-link").mouseleave(function(e) {
    if (!isHovered && e.clientY <= $(this).offset().top + $(this).height()) {
        $('#hoveredCategoryProducts').hide();
    }
    });


    // Функции для отслеживания наведения на #hoveredCategoryProducts
    $('#hoveredCategoryProducts').mouseenter(function() {
        isHovered = true;
    }).mouseleave(function() {
        isHovered = false;
        $('#hoveredCategoryProducts').hide();
    });
});


  </script>
  </header>
